# 任务步骤
steps:
  - name: 检出代码 (Checkout repository)
    uses: actions/checkout@v4

  - name: 设置 Java JDK 17 (Set up JDK 17)
    uses: actions/setup-java@v4
    with:
      java-version: '17'
      distribution: 'temurin'
      cache: 'gradle' # 缓存 Gradle 依赖，加快构建速度

  - name: 授予 Gradle Wrapper 执行权限 (Grant execute permission for gradlew)
    run: chmod +x gradlew

  - name: 运行 Release 构建 (Run Release Build)
    # 运行 Gradle 命令，生成 Release 版本的 APK
    run: ./gradlew assembleRelease

  - name: 上传 APK 文件 (Upload Release APK as artifact)
    uses: actions/upload-artifact@v4
    with:
      name: web2app-release-apk
      # 查找生成的 APK 文件并上传
      path: android_shell/build/outputs/apk/release/*.apk
      retention-days: 5
